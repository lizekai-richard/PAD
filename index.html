<!DOCTYPE html>
<html>
<link href="https://fonts.cdnfonts.com/css/chalkduster" rel="stylesheet">
<style>
    @import url('https://fonts.cdnfonts.com/css/chalkduster');
</style>

<head>
    <!--<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>-->

	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>-->
    <!--<script src="http://www.google.com/jsapi" type="text/javascript"></script>-->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

    <link href="styles.css" rel="stylesheet" />
    <link href="fontawesome.all.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
	<script defer src="fontawesome.all.min.js"></script>

    <script src="script.js"></script>

<!--    <link rel="icon" type="image/png" href="webpage_assets/dreamsim_icon.png" />-->

    <title>Prioritize Alignment in Dataset Distillation</title>
<!--    <meta property="og:image" content="./webpage_assets/teaser.jpg">-->
    <!-- Facebook automatically scrapes this. Go to https://developers.facebook.com/tools/debug/ if you update and want to force Facebook to rescrape. -->
    <meta property="og:title" content="Prioritize Alignment in Dataset Distillation">
    <meta property="og:description" content="We filter misaligned information introduced by previous matching-based Dataset Distillation methods
                                             and achieve new SOTA results.">

    <!-- Get from Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src=""></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-75863369-6');
    </script>
</head>

<body>
    <br>
    <center>
        <span class="near-black" style="font-size:36px;font-weight:bold">Prioritize Alignment in Dataset Distillation</span>
        <br>
<!--		<span class="near-black" style="font-size:36px;font-weight:bold">Human Visual Similarity using Synthetic Data</span>-->
<!--        <br>-->
<!--		<span class="near-black" style="font-size:32px;">NeurIPS 2023 Spotlight</span>-->
<!--        <br>-->
        <table align="center" width="900px">
            <tbody>
                <tr>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Zekai
                                    Li<sup style="vertical-align: sub;padding-left: 2px">*</sup><sup style="font-size: 0.7em;">1</sup>
                            </span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Ziyao Guo<sup style="vertical-align: sub;padding-left: 2px">*</sup><sup
                                        style="font-size: 0.7em;">2</sup></span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Wangbo Zhao<sup
                                        style="font-size: 0.7em;">1</sup></span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Tianle Zhang<sup style="font-size: 0.7em;padding-left: 1px;">2</sup></span>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table align="center" width="675px">
            <tbody>
                <tr>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Zhi-Qi Cheng<sup
                                        style="font-size: 0.7em;padding-left: 2px;">3</sup></span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Samir Khaki<sup style="font-size: 0.7em;padding-left: 2px;">4</sup></span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:22px">Kaipeng Zhang<sup
                                        style="font-size: 0.7em;padding-left: 1px;">5</sup></span>
                        </center>
                    </td>
            </tbody>
        </table>

        <table align="center" width="880px">
            <tbody>
                <tr>
                    <td align="center" width="200px">
                        <center>
                            <span style="font-size:22px">Ahmad Sajedi<sup
                                        style="font-size: 0.7em;padding-left: 1px;">4</sup></span>
                        </center>
                    </td>
                    <td align="center" width="190px">
                        <center>
                            <span style="font-size:22px">Kai Wang<sup
                                        style="font-size: 0.7em;padding-left: 1px;">1</sup></span>
                        </center>
                    </td>
                    <td align="center" width="300px">
                        <center>
                            <span style="font-size:22px">Konstantinos N Plataniotis<sup
                                        style="font-size: 0.7em;padding-left: 1px;">3</sup></span>
                        </center>
                    </td>
                    <td align="center" width="190px">
                        <center>
                            <span style="font-size:22px">Yang You<sup
                                        style="font-size: 0.7em;padding-left: 1px;">1</sup></span>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table align="center" width="500px">
            <tbody>
                <tr>
                    <td style="padding:10px">
						<sup style="padding-right: 2px;font-size: 18px;top: -0.85em;">1</sup><img style="width:80px;height:60px" src="webpage_assets/nus.png">
                    </td>
                    <td style="padding:10px">
						<sup style="padding-right: 2px;font-size: 18px;top: -0.85em;">2</sup><img style="width:80px;height:60px" src="webpage_assets/xidian.png">
                    </td>
                    <td style="padding:10px">
						<sup style="padding-right: 2px;font-size: 18px;top: -0.85em;">3</sup><img style="width:80px;height:60px" src="webpage_assets/cmu.png">
                    </td>
                    <td style="padding:10px">
						<sup style="padding-right: 2px;font-size: 18px;top: -0.85em;">3</sup><img style="width:80px;height:60px" src="webpage_assets/ut.png">
                    </td>
                    <td style="padding:10px">
						<sup style="padding-right: 2px;font-size: 18px;top: -0.85em;">3</sup><img style="width:80px;height:60px" src="webpage_assets/shanghaiailab.png">
                    </td>
                </tr>
            </tbody>
        </table>
        <table align="center" width="500px">
            <tbody>
                <tr>
                    <td align="center" width="500px">
                        <center>
                            <i><span style="font-size:14px">* Equal contribution, order decided by random
                                    seed</span></i>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table width="800" border="0" align="center" class="menu"
            style="margin-bottom: 20px;margin-top: 20px;font-weight: bold;font-size: 20px;">
            <tbody>
                <tr>
                    <td align="center">
						<!--<span class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" style="vertical-align:top;height:36px">
							<a style="color:inherit;text-decoration:none;font-size:15px" href="./2306.09344.pdf" target="_blank">
							<i style="padding-right:2px;font-size:23px" class="fa fa-file-pdf" aria-hidden="true"></i>
							Paper
							</a>
						</span>-->
						<span class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" style="vertical-align:top;height:36px">
							<a style="vertical-align:sub;color:inherit;text-decoration:none;font-size:15px" href="https://arxiv.org/abs/2306.09344" target="_blank">
							<i style="padding-right:2px;font-size:20px" class="ai ai-arxiv" aria-hidden="true"></i>
							Arxiv
							</a>
						</span>
						<span class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" style="vertical-align:top;height:36px">
							<a style="color:inherit;text-decoration:none;font-size:15px" href="https://github.com/ssundaram21/dreamsim" target="_blank">
							<i style="padding-right:2px;font-size:23px" class="fab fa-github" aria-hidden="true"></i>
							Code
							</a>
						</span>
                    </td>
                </tr>
                <tr>
                    <td align="center">
						<span class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" style="vertical-align:top;height:36px">
							<a style="vertical-align:sub;color:inherit;text-decoration:none;font-size:15px" href="https://try.fiftyone.ai/datasets/nights/samples" target="_blank">
							<img style="padding-bottom:5px;padding-right:2px;font-size:20px;height:22px" src="webpage_assets/voxel51.png" aria-hidden="true"></img>
							Distilled Dataset!
							</a>
						</span>
						<span class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" style="vertical-align:top;height:36px">
							<a style="vertical-align:sub;color:inherit;text-decoration:none;font-size:15px" href="#bibtex" target="_self">
							<i style="padding-right:2px;font-size:20px" class="fa fa-quote-left" aria-hidden="true"></i>
							Bibtex
							</a>
						</span>
                    </td>
                </tr>
            </tbody>
        </table>

    </center>

<!--    <center>-->
<!--        <img class="round" style="width:900px" src="webpage_assets/teaser.jpg">-->
<!--    </center>-->
<!--    <br>-->
<!--	<p id="teaser-description">-->
<!--        <span id="bold">Which image, A or B, is most similar to the reference?</span>-->
<!--		We generate a new benchmark of synthetic image triplets that span a wide range of mid-level variations, labeled with human similarity judgments.-->
<!--		The dots below each image indicate which image is considered most similar to the reference by humans vs several existing metrics and our new metric, DreamSim.-->
<!--    </p>-->
	<br>
    <hr>

    <center>
        <h1>Abstract</h1>
    </center>
    <table align="center" width="900px">

        <tbody>
            <tr>
                <td>
                    Dataset Distillation aims to compress a large dataset into a significantly more compact,
                    synthetic one without compromising the performance of the trained models. To achieve this,
                    existing methods use the agent model to extract information from the target dataset and
                    embed it into the distilled dataset. Consequently, the quality of extracted and embedded
                    information determines the quality of the distilled dataset. In this work, we find that
                    existing methods introduce misaligned information in both information extraction and embedding
                    stages. To alleviate this, we propose Prioritize Alignment in Dataset Distillation (PAD),
                    which aligns information from the following two perspectives. 1) We prune the target dataset
                    according to the compressing ratio to filter the information that can be extracted by the agent
                    model. 2) We use only deep layers of the agent model to perform the distillation to avoid
                    excessively introducing low-level information. This simple strategy effectively filters out
                    misaligned information and brings non-trivial improvement for mainstream matching-based distillation
                    algorithms. Furthermore, built on trajectory matching, \textbf{PAD} achieves remarkable improvements
                    on various benchmarks, achieving state-of-the-art performance.

                </td>
            </tr>
        </tbody>
    </table>
<!--    <br>-->
<!--    <hr>-->
<!--    <center>-->
<!--        <h1>Installation and Usage</h1>-->
<!--    </center>-->
<!--    <div class="container-fluid" id="code-container" align="center" width="900px">-->
<!--        <div class="row">-->
<!--            <div class="col" id="pip-container" class="code-col" style="flex-direction: column;display:flex;" >-->
<!--            <p>Installation:</p>-->
<!--            <code>-->
<!--                git clone https://github.com/lizekai-richard/PAD.git-->
<!--            </code>-->
<!--			<br>-->
<!--			<div style="flex-grow: 1;"></div>-->
<!--			<p> Environment: </p>-->
<!--            <code>-->
<!--                <br>-->
<!--                conda env create -f environment.yaml-->
<!--                <br> <br>-->
<!--                conda activate distillation-->
<!--                <br>-->
<!--            </code>-->
<!--            </div>-->
<!--            <div class="col" id="example-container" class="code-col" style="flex-direction: column;display:flex;">-->
<!--                <p>Usage:</p>-->
<!--                <code>-->
<!--				# Train Expert Trajectories-->
<!--				<br>-->
<!--                    cd buffer-->
<!--                    python buffer_CL.py &#45;&#45;dataset=CIFAR10 &#45;&#45;model=ConvNet &#45;&#45;train_epochs=100 &#45;&#45;num_experts=100 &#45;&#45;zca &#45;&#45;buffer_path=../buffer_storage/-->
<!--                <br><br>-->
<!--                    &#45;&#45;data_path=../dataset/ &#45;&#45;sort_method="CIFAR10_GraNd" &#45;&#45;init_ratio=0.75 &#45;&#45;add_end_epoch=20 &#45;&#45;rm_epoch_first=40 &#45;&#45;rm_epoch_second=60-->
<!--                <br><br>-->
<!--                    &#45;&#45;rm_easy_ratio_first=0.1 &#45;&#45;rm_easy_ratio_second=0.2-->
<!--                    <br>-->
<!--                <br>-->
<!--				# Distillation (filter parameters by depth)-->
<!--                    cd distill-->
<!--				<br>-->
<!--                    python PAD_depth.py &#45;&#45;cfg ../configs/xxxx.yaml-->
<!--                <br>-->
<!--                # Distillation (filter parameters by loss)-->
<!--                <br>-->
<!--				<br>-->
<!--                python PAD_loss.py &#45;&#45;cfg ../configs/xxxx.yaml-->
<!--            </code>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    <br>-->
<!--    <hr>-->


    <center>
        <h1>Method</h1>
    </center>

    <center>
        <div class="container-fluid" id="method-container" align="center" width="900px">
            <div class="row">
                <div class="col" id="method-figure">
                    <img class="round" style="width:500px" src="webpage_assetsethod.png">
                </div>
                <div class="col" id="method-description">
                    Our perceptual metric is a pairwise image distance, computed as the cosine distance
                    between concatenated backbone model features. We train via a hinge loss on image triplets,
                    training via <a style="color:#f14d68" href="https://arxiv.org/abs/2106.09685">Low-Rank Adaptation (LoRA)</a>.
                </div>
            </div>
        </div>

    </center>
    <br>
    <hr>
    <center>
        <h1>Nearest Neighbors Experiment</h1>
    </center>
    <br>
    <table width="900px" border="0" align="center">
        <tbody>
            <tr>
                <div id="nnCarousel" class="carousel slide teaser-carousel" data-ride="carousel" data-interval="7000">
				    <ol class="carousel-indicators">
                        <li data-target="#nnCarousel" data-slide-to="0" class="active"></li>
                        <li data-target="#nnCarousel" data-slide-to="1"></li>
                        <li data-target="#nnCarousel" data-slide-to="2"></li>
                        <li data-target="#nnCarousel" data-slide-to="3"></li>
                        <li data-target="#nnCarousel" data-slide-to="4"></li>
                        <li data-target="#nnCarousel" data-slide-to="5"></li>
                        <li data-target="#nnCarousel" data-slide-to="6"></li>
                        <li data-target="#nnCarousel" data-slide-to="7"></li>
                        <li data-target="#nnCarousel" data-slide-to="8"></li>
                        <li data-target="#nnCarousel" data-slide-to="9"></li>
                    </ol>

                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_1.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_7.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_3.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_10.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_8.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_5.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_6.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_2.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_9.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="webpage_assetsn_4.jpg">
                            </div>
                        </div>
                    </div>

                    <a class="carousel-control-prev" href="#nnCarousel" role="button" data-slide="prev"
                        style="height: 500px;">
                        <div class="slider-navigation-previous">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-right: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="45.63,75.8 0.375,38.087 45.63,0.375 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#nnCarousel" role="button" data-slide="next"
                        style="height: 500px;">
                        <div class="slider-navigation-next">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-left: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="0.375,0.375 45.63,38.087 0.375,75.8 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

            </tr>
        </tbody>
    </table>
    <br>
    <br>
    <br>
    <br>
    <br>
	<p id="nn-description">
        <span id="bold">Nearest-neighbor retrieval.</span>
        We perform a nearest neighbor search on the ImageNet-R and COCO datasets using different metrics.
		Although the datasets include images outside of our training domain, our model consistently retrieves neighbors with similar appearance and class to that of the query image.
    </p>
    <hr>
    <center>
        <h1>Inversion Experiment</h1>
    </center>
    <br>
    <table width="900px" border="0" align="center">
        <tbody>
            <tr>
                <div id="inversionCarousel" class="carousel slide inversion-carousel" data-ride="carousel"
                    data-interval="7000">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div>
                                <img class="inversion-img" src="webpage_assetsnversion_1.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="webpage_assetsnversion_2.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="webpage_assetsnversion_3.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="webpage_assetsnversion_4.jpg">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="webpage_assetsnversion_5.jpg">
                            </div>
                        </div>
                    </div>

                    <ol class="carousel-indicators" style="bottom: -35px;">
                        <li data-target="#inversionCarousel" data-slide-to="0" class="active"></li>
                        <li data-target="#inversionCarousel" data-slide-to="1"></li>
                        <li data-target="#inversionCarousel" data-slide-to="2"></li>
                        <li data-target="#inversionCarousel" data-slide-to="3"></li>
                        <li data-target="#inversionCarousel" data-slide-to="4"></li>
                    </ol>

                    <a class="carousel-control-prev" href="#inversionCarousel" role="button" data-slide="prev"
                        style="height: 500px;">
                        <div class="slider-navigation-previous">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-right: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="45.63,75.8 0.375,38.087 45.63,0.375 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#inversionCarousel" role="button" data-slide="next"
                        style="height: 500px;">
                        <div class="slider-navigation-next">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-left: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="0.375,0.375 45.63,38.087 0.375,75.8 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

            </tr>
        </tbody>
    </table>
    <br>
    <p id="inversion-description">
        <span id="bold">Feature inversion across different metrics and image priors.</span>
        Given a target image, we optimize for an image, where the objective is to match the target image
        embedding of a given backbone.
        Without any image prior (Optimization), our metric recovers better the color, shape and semantics
        of the target image. With a weak image prior (DIP Inversion), our metric is better able to reproduce scene
        structure and semantics. Using a diffusion model as a strong prior, our metric better captures overall semantics
        and scene appearance.
    </p>
    <br>
    <hr>
    <center>
        <h1>Acknowledgements</h1>
        <table align="center" width="900px">
            <tbody>
                <tr>
                    <td>
                        We thank Jim DiCarlo, Liad Mudrik, Nitzan Censor for fruitful discussions throughout the project. Additionally, we thank Narek Tumanyan for his insightful comments over the course of the project. Finally, we thank Michelle Li for proofreading sections of this paper and offering helpful comments.
						<br>
						<br>
						This work was supported by the NSF GRFP Fellowship to Shobhita Sundaram, the Meta PhD Fellowship to Lucy Chai, the Israeli Science Foundation (grant 2303/20) to Tali Dekel, and the Packard Fellowship to Phillip Isola. 
					</td>
                </tr>
            </tbody>
        </table>
    </center>
    <br>
    <hr>
    <center>
        <h1 name="bibtex" id="bibtex">Bibtex</h1>
    </center>
    <div class="col" class="code-col">
        <code style="font-size: 14px;">
            @article{fu2023learning,<br>
                &ensp;title={DreamSim: Learning New Dimensions of Human Visual Similarity using Synthetic Data},<br>
                &ensp;author={Stephanie Fu* and Netanel Tamir* and Shobhita Sundaram* and Lucy Chai and Richard Zhang and Tali Dekel and Phillip Isola},<br>
                &ensp;journal={arXiv:2306.09344},<br>
                &ensp;year={2023}<br>
              }
        </code>
    </div>
    <br>
    <hr>
</body>

</html>